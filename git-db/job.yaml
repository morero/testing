apiVersion: batch/v1
kind: Job
metadata:
  name: git-db-job
spec:
  template:
    spec:
      containers:
      - name: yugabyte-client
        image: yugabytedb/yugabyte-client
        command: ["/home/yugabyte/bin/ysqlsh", "-h", "yb-tservers", "-c", "CREATE DATABASE gitea"]
      restartPolicy: Never
  backoffLimit: 4
---
apiVersion: batch/v1
kind: Job
metadata:
  name: git-db-user
spec:
  template:
    spec:
      containers:
        - name: yugabyte-client
          image: yugabytedb/yugabyte-client
          command: ["/home/yugabyte/bin/ysqlsh", "-h", "yb-tservers", "-c", "CREATE USER gitea WITH PASSWORD 'gitea'"]
      restartPolicy: Never
  backoffLimit: 4
---
apiVersion: batch/v1
kind: Job
metadata:
  name: git-db-grant
spec:
  template:
    spec:
      containers:
        - name: yugabyte-client
          image: yugabytedb/yugabyte-client
          command: ["/home/yugabyte/bin/ysqlsh", "-h", "yb-tservers", "-c", "GRANT ALL ON DATABASE gitea TO gitea"]
      restartPolicy: Never
  backoffLimit: 4


