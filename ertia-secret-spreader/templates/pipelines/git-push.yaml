
apiVersion: tekton.dev/v1beta1
kind: ClusterTask
metadata:
  name: git-push
spec:
  params:
    - name: GIT_URL
      type: string
    - name: GIT_TOKEN
      type: string
  workspaces:
    - name: source
  steps:
    - name: pushs
      workingDir: $(workspaces.source.path)
      image: docker.io/alpine/git:v2.26.2@sha256:23618034b0be9205d9cc0846eb711b12ba4c9b468efdd8a59aac1d7b1a23363f 
      script: |
          #!/usr/bin/env sh
          set -eu
          echo $(ls)
          echo $(pwd)
          echo "https://$(params.GIT_URL)"
          git remote add ertia-git "https://$(params.GIT_URL)"
          echo "https://$(params.GIT_TOKEN)@$(params.GIT_URL)}"
          git push  "http://$(params.GIT_TOKEN)@$(params.GIT_URL)}" ertia-git main
